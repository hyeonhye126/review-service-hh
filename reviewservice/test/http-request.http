### ============================================
### ğŸ”„ ìˆœì°¨ì  íë¦„: ë¡œê·¸ì¸ â†’ ë¦¬ë·° ìƒì„± â†’ ì¡°íšŒ â†’ ìˆ˜ì • â†’ ì‚­ì œ
### ============================================

### ============================================
### STEP 1ï¸âƒ£: ë¡œê·¸ì¸ (merong4473)
### ============================================

POST {{user_base_url}}/users/login
Content-Type: application/json

{
  "username": "merong4473",
  "password": "Test@1234"
}

> {%
  if (response.status === 200) {
    const token = response.body.accessToken;
    client.global.set("auth_token", token);
    
    client.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ! (merong4473)");
    client.log("ğŸ“Œ í† í° ì €ì¥ë¨");
  } else {
    client.log("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 2ï¸âƒ£: ë¦¬ë·° ìƒì„±
### ============================================

POST {{base_url}}/api/v1/reviews/{{storeId}}/orders/{{orderId}}
Authorization: Bearer {{auth_token}}
Content-Type: application/json

{
  "rating": 5,
  "content": "ì •ë§ ë§›ìˆëŠ” ìŒì‹ì…ë‹ˆë‹¤! ë°°ì†¡ë„ ë¹ ë¥´ê³  ì¹œì ˆí–ˆì–´ìš”. ë‹¤ì‹œ ë˜ ì£¼ë¬¸í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤."
}

> {%
  if (response.status === 201) {
    const reviewId = response.body.reviewId;
    client.global.set("created_review_id", reviewId);
    
    client.log("âœ… ë¦¬ë·° ìƒì„± ì„±ê³µ!");
    client.log("ğŸ“Œ reviewId ì €ì¥ë¨");
  } else {
    client.log("âŒ ë¦¬ë·° ìƒì„± ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 3ï¸âƒ£: ë¦¬ë·° ì¡°íšŒ - ê°€ê²Œë³„ ëª©ë¡
### ============================================

GET {{base_url}}/api/v1/reviews/store/{{storeId}}?page=1&size=10
Content-Type: application/json

> {%
  if (response.status === 200) {
    const totalElements = response.body.totalElements || 0;
    client.log("âœ… ê°€ê²Œë³„ ë¦¬ë·° ì¡°íšŒ ì„±ê³µ!");
    client.log("ğŸ“Š ì´ ë¦¬ë·° ê°œìˆ˜: " + totalElements);
  } else {
    client.log("âŒ ì¡°íšŒ ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 3-2ï¸âƒ£: ë¦¬ë·° ì¡°íšŒ - ì£¼ë¬¸ë³„ ë‹¨ì¼ ì¡°íšŒ
### ============================================

GET {{base_url}}/api/v1/reviews/order/{{orderId}}
Content-Type: application/json

> {%
  if (response.status === 200) {
    client.log("âœ… ì£¼ë¬¸ë³„ ë¦¬ë·° ì¡°íšŒ ì„±ê³µ!");
  } else {
    client.log("âŒ ì¡°íšŒ ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 3-3ï¸âƒ£: ë‚´ ë¦¬ë·° ëª©ë¡ ì¡°íšŒ
### ============================================

GET {{base_url}}/api/v1/reviews?page=1&size=10
Authorization: Bearer {{auth_token}}
Content-Type: application/json

> {%
  if (response.status === 200) {
    const reviews = response.body.content || [];
    const totalElements = response.body.totalElements || 0;
    
    client.log("âœ… ë‚´ ë¦¬ë·° ëª©ë¡ ì¡°íšŒ ì„±ê³µ!");
    client.log("ğŸ“Š ë‚˜ì˜ ë¦¬ë·° ê°œìˆ˜: " + totalElements);
  } else {
    client.log("âŒ ì¡°íšŒ ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 4ï¸âƒ£: ë¦¬ë·° ìˆ˜ì •
### ============================================

PUT {{base_url}}/api/v1/reviews/{{created_review_id}}
Authorization: Bearer {{auth_token}}
Content-Type: application/json

{
  "rating": 4,
  "content": "ë‹¤ì‹œ ìƒê°í•´ë³´ë‹ˆ ì¡°ê¸ˆ ë¹„ì‹¼ ê²ƒ ê°™ì•„ìš”. í•˜ì§€ë§Œ ë§›ê³¼ í’ˆì§ˆì€ í›Œë¥­í•©ë‹ˆë‹¤!"
}

> {%
  if (response.status === 200) {
    client.log("âœ… ë¦¬ë·° ìˆ˜ì • ì„±ê³µ!");
    client.log("ë³€ê²½ í›„: rating=" + response.body.rating);
  } else {
    client.log("âŒ ë¦¬ë·° ìˆ˜ì • ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 5ï¸âƒ£: ë¦¬ë·° ì‚­ì œ
### ============================================

DELETE {{base_url}}/api/v1/reviews/{{created_review_id}}
Authorization: Bearer {{auth_token}}

> {%
  if (response.status === 204) {
    client.log("âœ… ë¦¬ë·° ì‚­ì œ ì„±ê³µ!");
  } else {
    client.log("âŒ ë¦¬ë·° ì‚­ì œ ì‹¤íŒ¨: " + response.status);
  }
%}

### ============================================
### STEP 6ï¸âƒ£: ì‚­ì œ í™•ì¸
### ============================================

GET {{base_url}}/api/v1/reviews/order/{{orderId}}
Content-Type: application/json

> {%
  if (response.status === 404) {
    client.log("âœ… ì‚­ì œ í™•ì¸ ì™„ë£Œ!");
  } else {
    client.log("âŒ ì˜ˆìƒ: 404 / ì‹¤ì œ: " + response.status);
  }
%}
